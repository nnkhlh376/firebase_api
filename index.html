<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>TÃ¬m POIs Viá»‡t Nam</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fjalla+One&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <!-- Leaflet Routing Machine CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Auth Button -->
  <button id="authBtn" class="auth-btn" aria-label="ÄÄƒng nháº­p">
    <span id="authIcon">ğŸ‘¤</span>
    <span id="authText">ÄÄƒng nháº­p</span>
  </button>

  <div id="controls">
    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
      <input type="text" id="placeInput" placeholder="Nháº­p tÃªn Ä‘á»‹a Ä‘iá»ƒm táº¡i Viá»‡t Namâ€¦" size="40" autocomplete="off">
      <button id="searchBtn">TÃ¬m</button>
    </div>
  </div>

  <!-- Weather info panel (populated by app.js) -->
  <div id="weatherInfo" class="weather-info" aria-live="polite"></div>
  <div id="map"></div>

  <!-- Quick Translate floating button -->
  <button id="quickTranslateBtn" class="qt-fab" aria-label="Dá»‹ch nhanh">ğŸŒ Dá»‹ch nhanh</button>

  <!-- Auth Modal Overlay + Popup -->
  <div id="authOverlay" class="qt-overlay is-hidden"></div>
  <div id="authPopup" class="auth-popup is-hidden" aria-modal="true" role="dialog">
    <div class="qt-header">
      <div class="qt-title">ğŸ” XÃ¡c thá»±c ngÆ°á»i dÃ¹ng</div>
      <button class="qt-close" id="authCloseBtn" aria-label="ÄÃ³ng">âœ•</button>
    </div>

    <!-- Auth Tabs -->
    <div class="auth-tabs">
      <button class="auth-tab active" data-tab="login">ÄÄƒng nháº­p</button>
      <button class="auth-tab" data-tab="register">ÄÄƒng kÃ½</button>
    </div>

    <!-- Message Area -->
    <div id="authMessage" class="auth-message is-hidden"></div>

    <!-- Login Form -->
    <div id="loginTab" class="auth-tab-content">
      <div class="qt-row">
        <label>Email</label>
        <input type="email" id="loginEmail" placeholder="example@email.com" required autocomplete="off">
      </div>
      <div class="qt-row">
        <label>Máº­t kháº©u</label>
        <input type="password" id="loginPassword" placeholder="Nháº­p máº­t kháº©u" required autocomplete="new-password">
      </div>
      <button class="qt-btn" id="loginBtn">ÄÄƒng nháº­p</button>
      
      <!-- NÃºt Ä‘Äƒng nháº­p Google -->
      <div class="google-box">
        <button id="googleLoginBtn" class="qt-btn google-btn">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" 
                 width="18" style="margin-right:8px;">
            ÄÄƒng nháº­p báº±ng Google
        </button>
      </div>
    </div>

    <!-- Register Form -->
    <div id="registerTab" class="auth-tab-content is-hidden">
      <div class="qt-row">
        <label>Email</label>
        <input type="email" id="registerEmail" placeholder="example@email.com" required autocomplete="off">
      </div>
      <div class="qt-row">
        <label>Máº­t kháº©u</label>
        <input type="password" id="registerPassword" placeholder="Tá»‘i thiá»ƒu 6 kÃ½ tá»±" required minlength="6" autocomplete="new-password">
      </div>
      <div class="qt-row">
        <label>XÃ¡c nháº­n máº­t kháº©u</label>
        <input type="password" id="registerPasswordConfirm" placeholder="Nháº­p láº¡i máº­t kháº©u" required autocomplete="new-password">
      </div>
      <button class="qt-btn" id="registerBtn">ÄÄƒng kÃ½</button>
    </div>

    <!-- User Info (shown after login) -->
    <div id="userInfoTab" class="auth-tab-content is-hidden">
      <!-- User Info Display -->
      <div id="userInfoDisplay">
        <div class="user-info-box">
          <div class="user-avatar">ğŸ‘¤</div>

          <div class="user-info-row">
            <strong>Email:</strong>
            <span id="userEmail">â€”</span>
          </div>

          <div class="user-info-row">
            <strong>User ID:</strong>
            <span id="userId">â€”</span>
          </div>

          <div class="user-info-row">
            <strong>XÃ¡c thá»±c email:</strong>
            <span id="userVerified">â€”</span>
          </div>

          <div class="user-info-row">
            <strong>TÃªn hiá»ƒn thá»‹:</strong>
            <span id="userDisplayName">â€”</span>
          </div>

          <div class="user-info-row" id="userPhotoRow" style="display:none;">
            <strong>áº¢nh Ä‘áº¡i diá»‡n:</strong>
            <img id="userPhoto" src="" width="60" height="60" style="border-radius:50%;">
          </div>
        </div>

        <button class="qt-btn" id="logoutBtn">ÄÄƒng xuáº¥t</button>
        <button class="qt-btn qt-btn-secondary" id="updateProfileBtn">âœï¸ Cáº­p nháº­t há»“ sÆ¡</button>
        <button class="qt-btn qt-btn-secondary" id="showChangePasswordBtn">ğŸ” Äá»•i máº­t kháº©u</button>
        <button class="qt-btn qt-btn-secondary" id="verifyEmailBtn">Gá»­i email xÃ¡c thá»±c</button>
        <button class="qt-btn qt-btn-danger" id="deleteAccountBtn">ğŸ—‘ï¸ XÃ³a tÃ i khoáº£n</button>
      </div>

      <!-- Change Password Section -->
      <div class="change-password-section is-hidden" id="changePasswordSection">
        <h4>ğŸ” Äá»•i máº­t kháº©u</h4>
        <div class="qt-row">
          <label>Máº­t kháº©u má»›i</label>
          <input type="password" id="newPassword" placeholder="Tá»‘i thiá»ƒu 6 kÃ½ tá»±" required minlength="6" autocomplete="new-password">
        </div>
        <div class="qt-row">
          <label>XÃ¡c nháº­n máº­t kháº©u</label>
          <input type="password" id="confirmNewPassword" placeholder="Nháº­p láº¡i máº­t kháº©u má»›i" required autocomplete="new-password">
        </div>
        <button class="qt-btn qt-btn-secondary" id="changePasswordBtn">Äá»•i máº­t kháº©u</button>
        <button class="qt-btn" id="cancelChangePasswordBtn">Há»§y</button>
      </div>

      <!-- Update Profile Section -->
      <div class="change-password-section is-hidden" id="updateProfileSection">
        <h4>âœï¸ Cáº­p nháº­t há»“ sÆ¡</h4>

        <div class="qt-row">
          <label>TÃªn hiá»ƒn thá»‹</label>
          <input type="text" id="profileDisplayName" placeholder="Nháº­p tÃªn hiá»ƒn thá»‹ má»›i" maxlength="50">
        </div>

        <div class="qt-row">
          <label>ğŸ”— URL áº£nh Ä‘áº¡i diá»‡n</label>
          <input type="url" id="profilePhotoURL" placeholder="https://i.postimg.cc/xxxxxxxx/image.jpg">
          <small style="color: #666; font-size: 12px; display: block; margin-top: 4px;">
            ğŸ’¡ Táº£i áº£nh lÃªn <a href="https://postimages.org/" target="_blank" style="color: #667eea;">Postimages</a> 
            rá»“i copy <strong>Direct link</strong> vÃ o Ä‘Ã¢y
          </small>
        </div>

        <button class="qt-btn qt-btn-secondary" id="saveProfileBtn">ğŸ’¾ LÆ°u thay Ä‘á»•i</button>
        <button class="qt-btn" id="cancelProfileBtn">Há»§y</button>
      </div>
    </div>
  </div>

  <!-- Quick Translate Modal Overlay + Popup -->
  <div id="qtOverlay" class="qt-overlay is-hidden"></div>
  <div id="qtPopup" class="qt-popup is-hidden" aria-modal="true" role="dialog">
    <div class="qt-header">
      <div class="qt-title" id="qtTitle">ğŸŒ Dá»‹ch nhanh</div>
      <button class="qt-close" id="qtCloseBtn" aria-label="ÄÃ³ng">âœ•</button>
    </div>

    <!-- Thanh chá»n ngÃ´n ngá»¯ -->
    <div class="qt-langbar">
      <label class="qt-lang">
        <!-- NgÃ´n ngá»¯ nguá»“n: máº·c Ä‘á»‹nh Tiáº¿ng Viá»‡t -->
        <select id="qtSrc" aria-label="NgÃ´n ngá»¯ nguá»“n">
          <option value="en">English</option>
          <option value="vi" selected>Tiáº¿ng Viá»‡t</option>
        </select>
      </label>

      <span class="qt-swap" title="Äá»•i chiá»u" id="qtSwap">â‡„</span>

      <label class="qt-lang">
        <!-- NgÃ´n ngá»¯ Ä‘Ã­ch: máº·c Ä‘á»‹nh English -->
        <select id="qtDest" aria-label="NgÃ´n ngá»¯ Ä‘Ã­ch">
          <option value="vi">Tiáº¿ng Viá»‡t</option>
          <option value="en" selected>English</option>
        </select>
      </label>
    </div>

    <div class="qt-panels">
      <div class="qt-panel qt-left">
        <textarea
          id="qtInput"
          class="qt-textarea"
          rows="4"
          maxlength="500"
          placeholder="Nháº­p vÄƒn báº£n cáº§n dá»‹châ€¦"></textarea>
        <div class="qt-bottom">
          <div class="qt-counter" id="qtCounter">0 / 500</div>
          <button id="qtTranslateBtn" class="qt-primary" disabled>Dá»‹ch</button>
        </div>
        <div class="qt-error" id="qtError" role="alert" hidden>
          CÃ³ lá»—i khi dá»‹ch. Vui lÃ²ng thá»­ láº¡i.
        </div>
      </div>

      <div class="qt-panel qt-right">
        <div id="qtOutput" class="qt-output" aria-live="polite"></div>
        <div class="qt-actions">
          <button id="qtCopyBtn" class="qt-secondary" title="Copy">ğŸ“‹ Copy</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Profile Modal -->
  <div id="editProfileOverlay" class="qt-overlay is-hidden"></div>
  <div id="editProfileModal" class="edit-profile-modal is-hidden" aria-modal="true" role="dialog">
    <div class="edit-profile-header">
      <h2>âœï¸ Chá»‰nh sá»­a há»“ sÆ¡</h2>
      <button class="qt-close" id="editProfileCloseBtn" aria-label="ÄÃ³ng">âœ•</button>
    </div>

    <div class="edit-profile-body">
      <!-- Avatar Section -->
      <div class="avatar-section">
        <div class="avatar-preview-container">
          <img id="avatarPreview" src="" alt="Avatar" class="avatar-preview">
          <div class="avatar-overlay">
            <label for="avatarUpload" class="avatar-upload-btn">
              ğŸ“· Chá»n áº£nh
            </label>
          </div>
        </div>
        <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
        <p class="avatar-hint">Hoáº·c nháº­p URL áº£nh bÃªn dÆ°á»›i</p>
      </div>

      <!-- Form Fields -->
      <div class="profile-form">
        <div class="form-group">
          <label for="editDisplayName">ğŸ‘¤ TÃªn hiá»ƒn thá»‹</label>
          <input type="text" id="editDisplayName" placeholder="Nháº­p tÃªn cá»§a báº¡n" maxlength="50">
          <span class="char-counter" id="nameCounter">0/50</span>
        </div>

        <div class="form-group">
          <label for="editPhotoUrl">ğŸ”— URL áº£nh Ä‘áº¡i diá»‡n</label>
          <input type="url" id="editPhotoUrl" placeholder="https://example.com/avatar.jpg">
        </div>
      </div>
    </div>

    <div class="edit-profile-footer">
      <button class="btn-cancel" id="editProfileCancelBtn">Há»§y</button>
      <button class="btn-save" id="editProfileSaveBtn">ğŸ’¾ LÆ°u thay Ä‘á»•i</button>
    </div>
  </div>


  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <!-- Leaflet Routing Machine JS -->
  <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
  <script type="module" src="auth.js"></script>
  <script src="app.js"></script>
</body>
</html>
